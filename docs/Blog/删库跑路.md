# 删库跑路
### [Home](../index)  [Blog](./BlogIndex)
## 业务=应用+数据
不论是什么场景下，业务都是应用与数据的结合，而且数据是应用的基础。一个典型的电商业务是由WEB应用与其商品数据、用户数据结合而成的；一个游戏，是由游戏应用与其图形建模、数值数据等结合而成。对于一个电商业务，没有商品数据就没有意义，没有用户数据就没有价值。而一个游戏，如果没有图形建模等就是一个劣质的桌游（可能连桌游都算不上），没有数值就连游玩的意义都没有了。  
所以说，数据也是业务的一个重要组成部分。可能我们开发时主要编写的是应用代码与业务逻辑，还有烦人的CRUD等，但是在设计和开发时，必须要考虑到数据的结构、存储、操作等。
## 数据的范围
狭义上的数据一般指的是存在数据库里的数据与配置文件等，比如我目前工作上使用的由Mysql和MongoDB，放宽点范围比如Yaml配置。  
广义上还能指一些IaC（Infrastructure as Code 基础设施即代码）、Dockerfile等环境配置代码仓，物理机、虚拟机、组网环境等的配置等等等等等等（大笑）。
## 对于数据的保护
目前的数据库、使用代码仓管理的配置文件等，其实都有比较好的保护机制来应对删库这种事情，像“删库跑路”这种事更像是一个玩笑，一般只会发生在不成熟的项目中。  
删库的恢复手段非常多：
- 备库 
- 回滚  
- 恢复(数据导入）
还有防删除的手段：
- 延迟删除
- 软删除

但是，对于广义上的数据，要么我们缺乏保护的意识，要么缺少手段去保护。有时我们会忘记备份，比如启动参数、服务器的rpm包列表等；有时对于VM、临时脚本、手工配置项，我们根本无从下手。对于前者，我们需要树立起保护的意识，养成备份的习惯，尽量使用软删除；对于后者，我们需要把临时性的东西固化下来，标准化下来。  
###  惨痛的教训

#### 1.删库
五月份发生了一起误删除
#### 2.VM删除
#### 3.集群扩容

## 对于数据库的保护
数据库是非常娇贵的。  
// TODO


